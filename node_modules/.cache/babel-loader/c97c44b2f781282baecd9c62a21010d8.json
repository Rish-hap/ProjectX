{"ast":null,"code":"import _regeneratorRuntime from\"/home/ajoncode/Rish-hap/ProjectX/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ajoncode/Rish-hap/ProjectX/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ajoncode/Rish-hap/ProjectX/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import LoginView from\"../Views/HomeView\";import{login,login_loading}from\"../actions/Auth\";import{set_user_data}from\"../actions/user\";import{global_error,global_error_clr}from\"../actions/global\";import{connect}from'react-redux';import Notif from'../Components/Notif';// import { ReCaptcha } from 'react-recaptcha-v3'\nimport FarmingView from\"../Views/FarmingView\";import Footer from\"../Components/Footer/Index.js\";import MetamaskContext from'../contexts/metamask';import{fessContractAddress,fnirContractAddress}from'../utils/config';function Farming(_ref){var fnirBalance=_ref.fnirBalance,getFnirBalance=_ref.getFnirBalance;var metamaskContextValue=React.useContext(MetamaskContext);var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),userApprove=_React$useState2[0],setUserApprove=_React$useState2[1];var _React$useState3=React.useState(0),_React$useState4=_slicedToArray(_React$useState3,2),allowance=_React$useState4[0],setAllowance=_React$useState4[1];var _React$useState5=React.useState(0),_React$useState6=_slicedToArray(_React$useState5,2),userSwap=_React$useState6[0],setUserSwap=_React$useState6[1];var _React$useState7=React.useState(0),_React$useState8=_slicedToArray(_React$useState7,2),fessBalance=_React$useState8[0],setFessBalance=_React$useState8[1];var getAllowance=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var allowanceValue;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return metamaskContextValue.fessContractInstance.methods.allowance(metamaskContextValue.ethereumAddress,fnirContractAddress).call();case 3:allowanceValue=_context.sent;setAllowance((Number(allowanceValue)/Math.pow(10,18)).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:4}));setUserSwap((Number(allowanceValue)/Math.pow(10,18)).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:4}));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log('Farming -> getAllowance: err: ',_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function getAllowance(){return _ref2.apply(this,arguments);};}();var getFessBalance=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var fessBalanceValue;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return metamaskContextValue.fessContractInstance.methods.balanceOf(metamaskContextValue.ethereumAddress).call();case 3:fessBalanceValue=_context2.sent;setFessBalance((Number(fessBalanceValue)/Math.pow(10,18)).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:4}));console.log('fessBalanceValue: ',fessBalanceValue);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.log('Farming -> getFessBalance: err: ',_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function getFessBalance(){return _ref3.apply(this,arguments);};}();var handleApprove=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var approveRequest;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(Number(userApprove)>0)){_context3.next=14;break;}_context3.prev=1;_context3.next=4;return metamaskContextValue.fessContractInstance.methods.approve(fnirContractAddress,metamaskContextValue.web3Instance.utils.toWei(String(userApprove),'ether')).send({from:metamaskContextValue.ethereumAddress,to:fessContractAddress});case 4:approveRequest=_context3.sent;console.log('approveRequest: ',approveRequest);getAllowance();getFessBalance();getFnirBalance();_context3.next=14;break;case 11:_context3.prev=11;_context3.t0=_context3[\"catch\"](1);console.log('Farming -> handleApprove: err: ',_context3.t0);case 14:case\"end\":return _context3.stop();}}},_callee3,null,[[1,11]]);}));return function handleApprove(){return _ref4.apply(this,arguments);};}();var handleSwap=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var swapRequest;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(Number(allowance)>0&&Number(userSwap)>0&&Number(allowance)>=Number(userSwap))){_context4.next=14;break;}_context4.prev=1;_context4.next=4;return metamaskContextValue.fnirContractInstance.methods.swapTokens(metamaskContextValue.web3Instance.utils.toWei(String(userSwap),'ether')).send({value:metamaskContextValue.web3Instance.utils.toWei(String(0.1),'ether'),from:metamaskContextValue.ethereumAddress,to:fnirContractAddress});case 4:swapRequest=_context4.sent;console.log('swapRequest: ',swapRequest);getAllowance();getFessBalance();getFnirBalance();_context4.next=14;break;case 11:_context4.prev=11;_context4.t0=_context4[\"catch\"](1);console.log('Farming -> handleSwap: err: ',_context4.t0);case 14:case\"end\":return _context4.stop();}}},_callee4,null,[[1,11]]);}));return function handleSwap(){return _ref5.apply(this,arguments);};}();React.useEffect(function(){if(metamaskContextValue.fessContractInstance&&metamaskContextValue.fnirContractInstance){getAllowance();getFessBalance();getFnirBalance();}},[metamaskContextValue.fessContractInstance,metamaskContextValue.fnirContractInstance]);console.log('allowance: ',allowance);console.log('fessBalance: ',fessBalance);console.log('fnirBalance: ',fnirBalance);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(FarmingView,{userApprove:userApprove,setUserApprove:setUserApprove,handleApprove:handleApprove,allowance:allowance,fessBalance:fessBalance,fnirBalance:fnirBalance,userSwap:userSwap,setUserSwap:setUserSwap,handleSwap:handleSwap// global_error = {props.global_error}\n}),/*#__PURE__*/React.createElement(Footer,null)));}var mapStateToProps=function mapStateToProps(state){return{auth_store:state.auth_store,login_ret:state.auth_store.login_ret,login_loading_flag:state.auth_store.login_loading,global_error_ret:state.global_store.global_error_ret};};export default connect(mapStateToProps,{login:login,login_loading:login_loading,global_error:global_error,global_error_clr:global_error_clr,set_user_data:set_user_data})(Farming);","map":{"version":3,"sources":["/home/ajoncode/Rish-hap/ProjectX/src/Containers/Farming.js"],"names":["React","LoginView","login","login_loading","set_user_data","global_error","global_error_clr","connect","Notif","FarmingView","Footer","MetamaskContext","fessContractAddress","fnirContractAddress","Farming","fnirBalance","getFnirBalance","metamaskContextValue","useContext","useState","userApprove","setUserApprove","allowance","setAllowance","userSwap","setUserSwap","fessBalance","setFessBalance","getAllowance","fessContractInstance","methods","ethereumAddress","call","allowanceValue","Number","Math","pow","toLocaleString","undefined","minimumFractionDigits","maximumFractionDigits","console","log","getFessBalance","balanceOf","fessBalanceValue","handleApprove","approve","web3Instance","utils","toWei","String","send","from","to","approveRequest","handleSwap","fnirContractInstance","swapTokens","value","swapRequest","useEffect","mapStateToProps","state","auth_store","login_ret","login_loading_flag","global_error_ret","global_store"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport LoginView from \"../Views/HomeView\"\nimport { login, login_loading } from \"../actions/Auth\"\nimport { set_user_data } from \"../actions/user\"\nimport { global_error, global_error_clr } from \"../actions/global\"\nimport { connect } from 'react-redux';\nimport Notif from '../Components/Notif'\n// import { ReCaptcha } from 'react-recaptcha-v3'\nimport FarmingView from \"../Views/FarmingView\"\nimport Footer from \"../Components/Footer/Index.js\"\n\nimport MetamaskContext from '../contexts/metamask';\n\nimport {\n  fessContractAddress,\n  fnirContractAddress\n} from '../utils/config';\n\nfunction Farming ({fnirBalance, getFnirBalance }){\n      const metamaskContextValue = React.useContext(MetamaskContext);\n\n      const [userApprove, setUserApprove] = React.useState(0);\n\n      const [allowance, setAllowance] = React.useState(0);\n\n      const [userSwap, setUserSwap] = React.useState(0);\n\n      const [fessBalance, setFessBalance] = React.useState(0);\n\n\n\n      const getAllowance = async () => {\n        try {\n          const allowanceValue = await metamaskContextValue.fessContractInstance.methods\n            .allowance(\n              metamaskContextValue.ethereumAddress,\n              fnirContractAddress,\n            )\n            .call();\n\n            setAllowance((\n              Number(allowanceValue) / Math.pow(10, 18)\n            ).toLocaleString(undefined, {\n              minimumFractionDigits: 2,\n              maximumFractionDigits: 4,\n            }))\n\n            setUserSwap((\n              Number(allowanceValue) / Math.pow(10, 18)\n            ).toLocaleString(undefined, {\n              minimumFractionDigits: 2,\n              maximumFractionDigits: 4,\n            }))\n        } catch (err) {\n          console.log('Farming -> getAllowance: err: ', err);\n        }\n      }\n\n      const getFessBalance = async () => {\n        try {\n          const fessBalanceValue = await metamaskContextValue.fessContractInstance.methods\n            .balanceOf(\n              metamaskContextValue.ethereumAddress\n            )\n            .call();\n\n            setFessBalance((\n              Number(fessBalanceValue) / Math.pow(10, 18)\n            ).toLocaleString(undefined, {\n              minimumFractionDigits: 2,\n              maximumFractionDigits: 4,\n            }))\n\n            console.log('fessBalanceValue: ', fessBalanceValue)\n        } catch (err) {\n          console.log('Farming -> getFessBalance: err: ', err);\n        }\n      }\n\n\n      const handleApprove = async() => {\n        if (Number(userApprove) > 0) {\n          try {\n          const approveRequest = await metamaskContextValue.fessContractInstance.methods\n          .approve(\n            fnirContractAddress,\n            metamaskContextValue.web3Instance.utils.toWei(\n              String(userApprove),\n              'ether',\n            ),\n          )\n          .send({\n            from: metamaskContextValue.ethereumAddress,\n            to: fessContractAddress,\n          });\n\n          console.log('approveRequest: ', approveRequest)\n\n          getAllowance();\n          getFessBalance();\n        getFnirBalance();\n        } catch (err) {\n          console.log('Farming -> handleApprove: err: ', err);\n        }\n        }\n      }\n\n      const handleSwap = async() => {\n        if (Number(allowance) > 0 && Number(userSwap) > 0  && Number(allowance) >= Number(userSwap)) {\n          try {\n          const swapRequest = await metamaskContextValue.fnirContractInstance.methods\n          .swapTokens(\n            metamaskContextValue.web3Instance.utils.toWei(\n              String(userSwap),\n              'ether',\n            ),\n          )\n          .send({\n            value:  metamaskContextValue.web3Instance.utils.toWei(\n              String(0.1),\n              'ether',\n            ),\n            from: metamaskContextValue.ethereumAddress,\n            to: fnirContractAddress,\n          });\n\n          console.log('swapRequest: ', swapRequest)\n\n          getAllowance();\n          getFessBalance();\n          getFnirBalance();\n        } catch (err) {\n          console.log('Farming -> handleSwap: err: ', err);\n        }\n        }\n\n      }\n\n      React.useEffect(() => {\n        if (\n          metamaskContextValue.fessContractInstance &&\n          metamaskContextValue.fnirContractInstance\n        ) {\n        getAllowance();\n        getFessBalance();\n        getFnirBalance();\n        }\n      }, [metamaskContextValue.fessContractInstance,\n        metamaskContextValue.fnirContractInstance])\n\n\n      console.log('allowance: ', allowance)\n      console.log('fessBalance: ', fessBalance)\n      console.log('fnirBalance: ', fnirBalance)\n\n        return (\n             <React.Fragment>\n                <div >\n                <FarmingView\n                    userApprove={userApprove}\n                    setUserApprove={setUserApprove}\n                    handleApprove={handleApprove}\n                    allowance={allowance}\n                    fessBalance={fessBalance}\n                    fnirBalance={fnirBalance}\n                    userSwap={userSwap}\n                    setUserSwap={setUserSwap}\n                    handleSwap={handleSwap}\n                    // global_error = {props.global_error}\n                  />\n               <Footer />\n                  {/* <Notif\n                     global_error = {props.global_error}\n                     global_error_ret = {props.global_error_ret}\n                     global_error_clr = {props.global_error_clr}\n                  /> */}\n                </div>\n             </React.Fragment>\n        )\n}\n\nconst mapStateToProps = state => ({\n  auth_store: state.auth_store,\n  login_ret:state.auth_store.login_ret,\n  login_loading_flag:state.auth_store.login_loading,\n  global_error_ret:state.global_store.global_error_ret\n})\n\nexport default connect(mapStateToProps, {\n  login,\n  login_loading,\n  global_error,\n  global_error_clr,\n  set_user_data\n })(Farming)"]},"metadata":{},"sourceType":"module"}